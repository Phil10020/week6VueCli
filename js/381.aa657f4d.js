"use strict";(self["webpackChunkweek6_homework"]=self["webpackChunkweek6_homework"]||[]).push([[381],{381:function(t,e,i){i.r(e),i.d(e,{default:function(){return P}});var a=i(252),n=i(577),l=i(963);const o={class:"container"},s=(0,a._)("h2",null,"購物車",-1),d={class:"table align-middle"},r=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"圖片"),(0,a._)("th",null,"商品名稱"),(0,a._)("th",null,"價格"),(0,a._)("th")])],-1),c={style:{width:"200px"}},u={key:0,class:"h5"},h={key:1},p={class:"h6"},g={class:"h5"},_={class:"btn-group btn-group-sm"},m=["disabled","onClick"],b=["disabled","onClick"],v={class:"spinner-grow spinner-grow-sm"},w=(0,a.Uk)(" 加到購物車 "),k={class:"text-end"},C={class:"table align-middle"},y=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th"),(0,a._)("th",null,"品名"),(0,a._)("th",{style:{width:"150px"}},"數量/單位"),(0,a._)("th",null,"單價")])],-1),f=["onClick"],x={class:"input-group input-group-sm"},I={class:"input-group mb-3"},D=["onUpdate:modelValue","onChange","disabled"],L=["value"],$={class:"input-group-text",id:"basic-addon2"},z={class:"text-end"},q=(0,a._)("td",{colspan:"3",class:"text-end"},"總計",-1),Z={class:"text-end"};function U(t,e,i,U,A,H){return(0,a.wg)(),(0,a.iD)("div",o,[s,(0,a._)("table",d,[r,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",c,[(0,a._)("div",{style:(0,n.j5)([{backgroundImage:`url(${e.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,a._)("td",null,(0,n.zw)(e.title),1),(0,a._)("td",null,[e.origin_price===e.price?((0,a.wg)(),(0,a.iD)("div",u,(0,n.zw)(e.price)+" 元 ",1)):((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("del",p,"原價 "+(0,n.zw)(e.origin_price)+" 元",1),(0,a._)("div",g,"現在只要 "+(0,n.zw)(e.price)+" 元",1)]))]),(0,a._)("td",null,[(0,a._)("div",_,[(0,a._)("button",{type:"button",class:"btn btn-outline-secondary",disabled:A.isLoadingItem===e.id,onClick:i=>t.openProductModal(e.id)}," 查看更多 ",8,m),(0,a._)("button",{disabled:A.isLoadingItem===e.id,onClick:t=>H.addToCart(e.id),type:"button",class:"btn btn-outline-danger"},[(0,a.wy)((0,a._)("span",v,null,512),[[l.F8,A.isLoadingItem===e.id]]),w],8,b)])])])))),128))])]),(0,a._)("div",k,[(0,a._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=(...t)=>H.removeCartAll&&H.removeCartAll(...t))}," 清空購物車 ")]),(0,a._)("table",C,[y,(0,a._)("tbody",null,[A.cartData.carts?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(A.cartData.carts,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>H.removeCartItem(t.id)}," x ",8,f)]),(0,a._)("td",null,(0,n.zw)(t.product.title),1),(0,a._)("td",null,[(0,a._)("div",x,[(0,a._)("div",I,[(0,a.wy)((0,a._)("select",{id:"",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>H.updateCartItem(t),disabled:A.isLoadingItem===t.id},[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(e=>(0,a._)("option",{value:e,key:`${e}-${t.id}`},(0,n.zw)(e),9,L))),64))],40,D),[[l.bM,t.qty]]),(0,a._)("span",$,(0,n.zw)(t.product.unit),1)])])]),(0,a._)("td",z,(0,n.zw)(t.total),1)])))),128)):(0,a.kq)("",!0)]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[q,(0,a._)("td",Z,(0,n.zw)(A.cartData.total),1)])])])])}var A=i(253),H={data(){return{cartData:{},products:[],isLoadingItem:""}},methods:{getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2//api/phil/products/all").then((t=>{this.products=t.data.products}))},addToCart(t,e=1){const i={product_id:t,qty:e};this.isLoadingItem=t,this.$http.post("https://vue3-course-api.hexschool.io/v2//api/phil/cart",{data:i}).then((t=>{console.log(t),this.isLoadingItem="",A.Z.emit("get-cart")}))},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2//api/phil/cart").then((t=>{this.cartData=t.data.data}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2//api/phil/cart/${t}`).then((()=>{this.getCart(),this.isLoadingItem="",A.Z.emit("get-cart")}))},removeCartAll(){this.$http.delete("https://vue3-course-api.hexschool.io/v2//api/phil/carts").then((()=>{this.getCart(),A.Z.emit("get-cart")}))},updateCartItem(t){const e={product_id:t.id,qty:t.qty};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2//api/phil/cart/${t.id}`,{data:e}).then((()=>{this.getCart(),this.isLoadingItem=""}))}},mounted(){A.Z.on("get-cart",(()=>{this.getCart()})),this.getProducts(),this.getCart()}},K=i(744);const M=(0,K.Z)(H,[["render",U]]);var P=M},253:function(t,e,i){function a(t){return{all:t=t||new Map,on:function(e,i){var a=t.get(e);a?a.push(i):t.set(e,[i])},off:function(e,i){var a=t.get(e);a&&(i?a.splice(a.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var a=t.get(e);a&&a.slice().map((function(t){t(i)})),(a=t.get("*"))&&a.slice().map((function(t){t(e,i)}))}}}i.d(e,{Z:function(){return l}});const n=a();var l=n}}]);
//# sourceMappingURL=381.aa657f4d.js.map